# HDU 选课系统

## 安装

1. 项目使用的 Python 版本是：Python 3.6.3。
2. 运行代码时可以先创建虚拟环境，具体请看：[pipenv](https://github.com/pypa/pipenv)。

```
$ pip3 install pipenv 
```

3. 创建项目文件夹

```
$ mkdir project
$ cd project
```

这时候可以把下载后的文件都放在 project 文件夹里了。

4. 创建虚拟环境

```
$ pipenv --python=python3.6
$ pipenv install
```

5. 启动虚拟环境

```
pipenv shell
```

6. 安装依赖包

```
pipenv install -r requirements.txt
```

验证码识别需要 pytesseract 的库依赖 Tesseract-OCR，所以需要事先安装。

github 地址：[Tesseract OCR](https://github.com/tesseract-ocr/tesseract)。

PS：嫌麻烦可以把验证码下载到本地，手动输入验证码。（需要自己修改源码。）

## 使用

初次尝试功能可以直接运行 main.py 文件

```
python3 main.py
```

运行后可以看到这些界面，具体功能自己选择即可：

```
(๑•̀ㅂ•́)و✧准备进入数字杭电...
请输入学号：XXXXXXXX
请输入密码（密码不回显）：
登录中...
登录成功！

>>>>>>>>>功能目录<<<<<<<<<

       1.考试安排查询
       2.期末成绩查询
       3.期末成绩预测
       4.自助选课
       5.退出

>>>>>>>>>>>结束<<<<<<<<<<<

请输入你的选择（输入数字即可）：
```

运行过程中会产生 cookies.txt 文件，或者下载了 CheckCode.png 验证码图片，不用太过惊讶。

## 介绍

1. 考试安排查询

输入查询学年，如：2017-2018；查询学期，如：1，可以得到查询后的考试安排打印结果。

```
请输入你的选择（输入数字即可）：1

请输入你想要查询的学年（如 2017-2018）：2017-2018
请输入你想要查询的学期（如 1）：1
正在进入考试安排页面...
成功进入！
开始爬取考试安排...
···
···
···
按 q 退出查询或其余任意键继续查询：
```

2. 期末成绩查询

输入查询学年，如：2017-2018；查询学期，如：1，可以得到查询后的期末成绩打印结果。包含学分、绩点、平均学分绩点、去 C 类课绩点、是否挂科和补考是否成功等信息。

```
请输入你的选择（输入数字即可）：2

请输入你想要查询的学年（如 2017-2018）：2017-2018
请输入你想要查询的学期（如 1）：1
正在进入选课系统成绩页面...
成功进入！
开始爬取成绩单...
2017-2018学年第1学期成绩表如下：
···
···
···
本学期所修学分为（含c类课）：36.0
本学期所修学分为（不含c类课）：30.0
本学期平均学分绩点为（含c类课）：4.301388888888889
本学期平均学分绩点为（不含c类课）：4.3350000000000005
按 q 退出查询或其余任意键继续查询：
```

3. 期末成绩预测

```
请输入你的选择（输入数字即可）：3

请输入你想要查询的学年（如 2017-2018）：2017-2018
请输入你想要查询的学期（如 1）：2
正在进入选课情况查询页面...
成功进入！
开始爬取选课情况信息...
本学期已选课程如下所示：
······
······
······
正在将信息写入文件(courses_results.txt)...
信息写入成功！请到相应目录打开 results/ 文件夹并在 courses_guess.txt 文件中写入推测成绩！
开始期末成绩预测：

*#*#*#*#*#*#*#*#*

 1.获取推测成绩表
 2.退出

*#*#*#*#*#*#*#*#*

请输入你的选择（输入数字即可）：
```
一些人可能会对自己的考试成绩充满期待，成绩预测可以爬取本学期的课程和学分等信息到本地来。在获得的 courses_guess.txt 文件中，每行末尾填入自己预估的成绩（分数后不要有空字符），重新运行可以获得预估成绩单。

4. 自助选课

```
请输入你的选择（输入数字即可）：4

正在进入选课页面...
开始爬取选课信息...
所有可选课程如下所示：
···
···
···

*#*#*#*#*#*#*#*#*

 1.按课程编号选课
 2.按课程名称选课
 3.查看已选课程
 4.退选已选课程
 5.退出

*#*#*#*#*#*#*#*#*

请输入你的选择（输入数字即可）：1

请输入将选课程的编号：2

下载验证码中...
http://jxgl.hdu.edu.cn/CheckCode.aspx 下载成功！
识别结果为：75410

φ(≧ω≦*)♪选课中...
......
成功完成选课٩(๑>◡<๑)۶！

已选课程如下所示：
···
···
···

*#*#*#*#*#*#*#*#*

 1.按课程编号选课
 2.按课程名称选课
 3.查看已选课程
 4.退选已选课程
 5.退出

*#*#*#*#*#*#*#*#*

请输入你的选择（输入数字即可）：
```

其中2功能还未开发（感觉用编号选课也可以了），按1功能选课时，如果安装好了 OCR 环境，直接输入显示出来的编号等待程序运行即可完成选课。其余功能等同。

**省略了 PrettyTable 展现出来的表格图像，可以运行程序自行查看。**

## 来源

之前学了爬虫真的是啥都想爬，然后目标就对准了选课系统...

整理所学，自行完成了这个简单的小项目，还是很开心的。

觉得不错就来踩踩我的博客吧：[青柚](http://home.junyouxiaowu.top/)。

